SLURM job started
/gpfs/alpine1/scratch/niho8409/podcast_othering
Loading anaconda...
Activating conda...
Running python...
Python works
Label mapping: {0: 'Deliberative', 1: 'ISQ', 2: 'OTHERS', 3: 'Rhetorical'}
Map:   0%|          | 0/151 [00:00<?, ? examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 151/151 [00:00<00:00, 6969.28 examples/s]
Map:   0%|          | 0/151 [00:00<?, ? examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 151/151 [00:00<00:00, 8338.80 examples/s]
Map:   0%|          | 0/151 [00:00<?, ? examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 151/151 [00:00<00:00, 7866.01 examples/s]
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
/gpfs/alpine1/scratch/niho8409/podcast_othering/train_no_context.py:124: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|â–Ž         | 1/40 [00:01<00:52,  1.34s/it]  5%|â–Œ         | 2/40 [00:01<00:25,  1.50it/s]  8%|â–Š         | 3/40 [00:01<00:16,  2.20it/s] 10%|â–ˆ         | 4/40 [00:01<00:12,  2.82it/s] 12%|â–ˆâ–Ž        | 5/40 [00:02<00:10,  3.33it/s] 15%|â–ˆâ–Œ        | 6/40 [00:02<00:09,  3.75it/s] 18%|â–ˆâ–Š        | 7/40 [00:02<00:08,  4.08it/s] 20%|â–ˆâ–ˆ        | 8/40 [00:02<00:07,  4.32it/s] 22%|â–ˆâ–ˆâ–Ž       | 9/40 [00:02<00:06,  4.51it/s] 25%|â–ˆâ–ˆâ–Œ       | 10/40 [00:03<00:05,  5.42it/s]
  0%|          | 0/19 [00:00<?, ?it/s][A
 21%|â–ˆâ–ˆ        | 4/19 [00:00<00:00, 34.12it/s][A
 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 8/19 [00:00<00:00, 28.38it/s][A
 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 11/19 [00:00<00:00, 27.10it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 14/19 [00:00<00:00, 26.50it/s][A
 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 17/19 [00:00<00:00, 26.08it/s][A                                               
                                               [A 25%|â–ˆâ–ˆâ–Œ       | 10/40 [00:03<00:05,  5.42it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:00<00:00, 26.08it/s][A
                                               [A 28%|â–ˆâ–ˆâ–Š       | 11/40 [00:05<00:23,  1.25it/s] 30%|â–ˆâ–ˆâ–ˆ       | 12/40 [00:05<00:17,  1.62it/s] 32%|â–ˆâ–ˆâ–ˆâ–Ž      | 13/40 [00:05<00:13,  2.03it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 14/40 [00:05<00:10,  2.47it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 15/40 [00:06<00:08,  2.91it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 16/40 [00:06<00:07,  3.33it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 17/40 [00:06<00:06,  3.69it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 18/40 [00:06<00:05,  4.00it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 19/40 [00:06<00:04,  4.25it/s]                                                50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 20/40 [00:06<00:04,  4.25it/s]{'eval_loss': 1.2632085084915161, 'eval_accuracy': 0.5231788079470199, 'eval_f1_weighted': 0.3594010941549093, 'eval_runtime': 0.7469, 'eval_samples_per_second': 202.175, 'eval_steps_per_second': 25.439, 'epoch': 1.0}
{'loss': 1.2784, 'grad_norm': 5.631433486938477, 'learning_rate': 1.1666666666666668e-05, 'epoch': 2.0}

  0%|          | 0/19 [00:00<?, ?it/s][A
 21%|â–ˆâ–ˆ        | 4/19 [00:00<00:00, 34.16it/s][A
 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 8/19 [00:00<00:00, 28.42it/s][A
 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 11/19 [00:00<00:00, 27.21it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 14/19 [00:00<00:00, 26.56it/s][A
 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 17/19 [00:00<00:00, 26.21it/s][A                                               
                                               [A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 20/40 [00:07<00:04,  4.25it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:00<00:00, 26.21it/s][A
                                               [A 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 21/40 [00:08<00:11,  1.67it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 22/40 [00:09<00:09,  2.00it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 23/40 [00:09<00:07,  2.37it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 24/40 [00:09<00:05,  2.76it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 25/40 [00:09<00:04,  3.16it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 26/40 [00:09<00:03,  3.52it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 27/40 [00:10<00:03,  3.85it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 28/40 [00:10<00:02,  4.11it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 29/40 [00:10<00:02,  4.34it/s]{'eval_loss': 1.1506808996200562, 'eval_accuracy': 0.5231788079470199, 'eval_f1_weighted': 0.3594010941549093, 'eval_runtime': 0.7441, 'eval_samples_per_second': 202.937, 'eval_steps_per_second': 25.535, 'epoch': 2.0}

  0%|          | 0/19 [00:00<?, ?it/s][A
 21%|â–ˆâ–ˆ        | 4/19 [00:00<00:00, 33.93it/s][A
 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 8/19 [00:00<00:00, 28.70it/s][A
 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 11/19 [00:00<00:00, 27.72it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 14/19 [00:00<00:00, 27.15it/s][A
 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 17/19 [00:00<00:00, 26.88it/s][A                                               
                                               [A 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 30/40 [00:11<00:02,  4.34it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:00<00:00, 26.88it/s][A
                                               [A 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 31/40 [00:12<00:05,  1.72it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 32/40 [00:12<00:03,  2.05it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 33/40 [00:12<00:02,  2.42it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 34/40 [00:13<00:02,  2.81it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 35/40 [00:13<00:01,  3.20it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 36/40 [00:13<00:01,  3.56it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 37/40 [00:13<00:00,  3.88it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 38/40 [00:13<00:00,  4.14it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 39/40 [00:14<00:00,  4.36it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:14<00:00,  5.22it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:14<00:00,  5.22it/s]{'eval_loss': 1.1392468214035034, 'eval_accuracy': 0.5231788079470199, 'eval_f1_weighted': 0.3594010941549093, 'eval_runtime': 0.7301, 'eval_samples_per_second': 206.835, 'eval_steps_per_second': 26.026, 'epoch': 3.0}
{'loss': 1.1672, 'grad_norm': 9.313660621643066, 'learning_rate': 5.555555555555555e-07, 'epoch': 4.0}

  0%|          | 0/19 [00:00<?, ?it/s][A
 21%|â–ˆâ–ˆ        | 4/19 [00:00<00:00, 35.23it/s][A
 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 8/19 [00:00<00:00, 29.37it/s][A
 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 11/19 [00:00<00:00, 28.06it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 14/19 [00:00<00:00, 27.40it/s][A
 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 17/19 [00:00<00:00, 27.02it/s][A                                               
                                               [A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:14<00:00,  5.22it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:00<00:00, 27.02it/s][A
                                               [A                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:16<00:00,  5.22it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:16<00:00,  2.43it/s]
{'eval_loss': 1.1204441785812378, 'eval_accuracy': 0.5231788079470199, 'eval_f1_weighted': 0.3594010941549093, 'eval_runtime': 0.7232, 'eval_samples_per_second': 208.787, 'eval_steps_per_second': 26.271, 'epoch': 4.0}
{'train_runtime': 16.4446, 'train_samples_per_second': 36.729, 'train_steps_per_second': 2.432, 'train_loss': 1.222830867767334, 'epoch': 4.0}
  0%|          | 0/19 [00:00<?, ?it/s] 21%|â–ˆâ–ˆ        | 4/19 [00:00<00:00, 35.43it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 8/19 [00:00<00:00, 29.58it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 12/19 [00:00<00:00, 28.08it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 15/19 [00:00<00:00, 27.50it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 18/19 [00:00<00:00, 27.16it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:00<00:00, 28.08it/s]
Test results: {'eval_loss': 1.1653120517730713, 'eval_accuracy': 0.5298013245033113, 'eval_f1_weighted': 0.3669619563659299, 'eval_runtime': 0.7175, 'eval_samples_per_second': 210.458, 'eval_steps_per_second': 26.481, 'epoch': 4.0}
Training complete.
DONE
